import"./chunk-K7C7TUE5.mjs";import{uncompressSync as t}from"lz4-napi";import f from"oodle";import{uncompress as i}from"snappyjs";var l=class{oodle;xorTable;constructor(e){this.oodle=new f.Oodle(e)}decrypt(e,n,r,s){if(s){if(!this.xorTable)throw new Error("Xor key not initialized");this.xor(e,n)}let o;switch(r){case 0:{o=e;break}case 1:{o=t(e);break}case 2:{o=i(e);break}case 3:{if(e.length<4)throw new Error(`Invalid oodle packet: size=${e.length}, comp=${r}, opcode=${n}`);o=this.oodle.decode(e.subarray(4),e.readUInt32LE(0));break}default:throw new Error(`Unknown compression: ${r}`)}if(o.length<16)throw new Error(`Invalid packet: size=${o.length}, comp=${r}, opcode=${n}`);return o.subarray(16)}xor(e,n){if(this.xorTable)for(let r=0;r<e.length;r++)e[r]^=this.xorTable[n++%256]}};export{l as Decompressor};
